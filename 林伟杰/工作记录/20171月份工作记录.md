# 2017年1月份工作记录 #
---
### 20170104星期三 ###
#### 今天工作内容日下： ####
- 优化了找茬小游戏中的图片插入，是图片从右边插入从左边移出。
- 浏览了一下模板开发及上线说明。
```javascript
{
	//从右边滑动插入图片
	puzzleOne = game.add.image(game.world.centerX,centerBg.centerY - this.puzzle.height - 10,firstPuzzle);
    puzzleOne.width = puzzleOne.width * Scale;
    puzzleOne.height = puzzleOne.height * Scale;
    //从右边插入动画，用时0.3秒
    game.add.tween(puzzleOne).to({
        x: centerBg.centerX - this.puzzle.width / 2,
        y: centerBg.centerY - this.puzzle.height - 10
    }, 300, Phaser.Easing.Linear.In, true, 0, 0, false);
    puzzleOne.x = centerBg.centerX - this.puzzle.width / 2;

	//从左边滑动移除图片
	game.add.tween(puzzleOne).to({
        x: - this.puzzle.width,
        y: centerBg.centerY - this.puzzle.height - 10
    }, 300, Phaser.Easing.Linear.Out, true, 0, 0, false);
}
```

---
### 20170112星期五工作记录 ###
#### 今天工作内容如下： ####
- 优化飞翔的小鸟小游戏：
	1. 利用cover效果对游戏背景和台阶进行缩放。
	2. 利用contain效果对小鸟进行缩放。
	3. 利用一个参数来计算管道的生成时间，以确定生成管道之间的左右间距。
	4. 优化了管道的缩放。
	5. 利用bitmapData画一个矩形来坐闪屏效果。

```javascript
{
	this.bg = game.add.image(0, 0, 'bg');
	if (this.bg.width > this.bg.height) { //利用cover效果进行缩放，使它铺满整个屏幕。
		var bgScale = game.world.height / bgTP.height;
	} else {
		bgScale = game.world.width / bgTP.width;
	}
	this.bg.scale.setTo(bgScale, bgScale);
	
	var groundTP = game.cache.getImage('ground');//现获加载进来的台阶。
	var gdScale = groundTP.width > groundTP.height ? game.world.height * 0.093 / groundTP.height : game.world.width / groundTP.width;

	this.bird = game.add.sprite(game.world.width * 0.33, game.world.height * 0.40, 'bird'); //鸟
	var birdScale = this.bird.width > this.bird.height ? game.world.width * 0.129 / this.bird.width : game.world.height * 0.0546 / this.bird.height;
	//生成管道的时间
	var newPipeTime = game.world.width * 0.4 / 200 * 1000;//game.world.width * 0.4是管道之间的左右距离
	//管道缩放
	var pipe = game.add.image(0, 0, 'pipe');
	pipe.destroy();
	var pipeScale = pipe.width > pipe.height ? (game.world.width * 0.153 / pipe.width) : (game.world.height * 0.544 / pipe.height);
	pipe.scale.setTo(pipeScale, pipeScale); 

	//小鸟死亡时的闪屏效果
	var whiteBg = game.add.bitmapData(game.world.width, game.world.height);
	whiteBg.ctx.beginPath();
	whiteBg.ctx.rect(0, 0, game.world.width, game.world.height);
	whiteBg.ctx.fillStyle = '#FCFCFC';
	whiteBg.ctx.fill();
	var whiteSprite = game.add.sprite(0, 0, whiteBg);
	whiteSprite.alpha = 0.8;
	var tween = game.add.tween(whiteSprite).to({
		alpha: 0
	}, 100, null, true, 0, 0, false);
}
```



- 上线飞翔的小鸟：
	1. 制作配置表。
	2. 生成php，在这个过程踩坑了，没有在顶级容器中天加一个game_div，导致游戏页面跑出开始页面。
	3. 接入平台接口，这个过程遇到的问题就是音效播放的借口得改。
	4. 本地构建及测试。

```javascript
{
	//在配置表中添加分数颜色选项
  "color": {
    "textColor": {
      "name": "分数颜色",
      "color": "#fffcd9"
    }
  }
	//生成php文件
	<!-- 引入公共头部 -->	
	<?php include("modules/head.php") ?>
	//body部分
	<div class="game-tpl-container">
		<!-- 飞翔的小鸟 分数类 Phaser -->
		<?php require_once('main.php'); ?>
		<div id="game_div"></div>
			<span id="fontText">12</span>
	        <script src="//24haowan-cdn.shanyougame.com/public/js/phaser.min.js"></script>
	        <script type="text/javascript" src="/static_resource/js/main.js?v=<?php echo Yii::app()->params['version']; ?>"></script>
    	</div>	
    </div>
	//接入到平台接口
	//创建音乐实例
	self.musicManager = new MusicManager(game, self.device, ['bgm', 'score_sound', 'fly_sound', 'hit_pipe_sound', 'gameover_sound']);
	//创建背景音乐
	this.soundBgm = self.musicManager.play("bgm", true);
	//停止背景音乐
	self.musicManager.stop("bgm");
	//播放其他音效
	if (self.device.platform != 'android') {
		self.musicManager.stop("score_sound");
		self.musicManager.play("score_sound");
	}
}
```